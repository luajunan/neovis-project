<!doctype html>
<html lang="en" data-bs-theme="dark">

<head>
    <title>Neovis.js Visualization</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

    <style>
        .spinner-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
    
        .spinner-text {
            color: white;
            margin-left: 10px;
        }
    </style>

</head>
    <script type="text/javascript" src="/Users/junan/Desktop/neovis.js/dist/neovis.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/neo4j-driver/lib/browser/neo4j-web.js"></script>
    <body onload="draw()">
        <div class="container-lg">
            <h1 class="mt-5 text-center">Neovis.js Visualization</h1>
        
            <div class="row justify-content-center mt-4">
                <div class="col-md-6">
                    <label for="cypher" class="form-label">Cypher Query:</label>
                    <textarea rows="4" class="form-control" id="cypher"></textarea>
                </div>
            </div>
        
            <div class="d-flex justify-content-center mt-4 gap-2">
                <!-- <div class="col-6 gap-2"> -->
                    <button class="btn btn-primary" type="submit" id="reload">Submit</button>
                    <button class="btn btn-primary" type="submit" id="stabilize">Stabilize</button>
                <!-- </div> -->
            </div>
        
            <div id="spinner" class="spinner mt-4"></div>
        </div>
        
    <script>
  


        $(document).ready(function () {
            // Graph generation logic for the 'Submit' button
            $("#reload").click(function () {


                var cypher = $("#cypher").val();

                if (cypher.length > 3) {
                    neoViz.renderWithCypher(cypher)
                    runCypherQuery(cypher);
                    console.log(cypher);
                    //const spinner = document.getElementById('spinner');
                    //spinner.style.display = 'block'; // Show spinner

                } else {
                    console.log("reload");
                    neoViz.reload();
                }

            });

            // Logic for the 'Stabilize' button
            $("#stabilize").click(function () {
                neoViz.stabilize();
            });
        });
        </script>

        <div id="spinnerContainer" class="spinner-container">
            <!-- Spinner and text -->
            <div class="spinner-border text-light" role="status">
                <span class="visually-hidden">Generating Graph...</span>
            </div>
            <span class="spinner-text">Generating Graph...</span>
            <!-- End Spinner and text -->
        </div>

        <div class="container-sm">
            <h2>Graph Output</h2>
        </div>

        <div id="viz" class="container-lg" style="width: 100%; height:600px; border: 1px solid #6c757d; border-radius: 5px;"></div>
        <table class="table table-dark table-hover table-bordered border-secondary mt-3", style="width: 75%; margin:0 auto;">
            <thead class="table-light">
                <tr>
                    <th>Node Type</th>
                    <th>Count</th>
                </tr>
            </thead>
            <tbody id="nodeCountTableBody">
                <!-- Placeholder rows for demonstration -->
                <!-- <tr>
                    <td>User</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>vIP</td>
                    <td>10</td>
                </tr>
                <tr>
                    <td>lIP</td>
                    <td>8</td>
                </tr> -->
            </tbody>
        </table>
    </div>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.1/css/all.css" />
    <script src="https://unpkg.com/neovis.js@2.0.2"></script>
    <script src="graphviz.js"></script>
    
    
</body>


</html>